<div class="page-section-float-left">
    <% if @course.status != "live" %>
    <div class="welcome-header">Hi, <%= current_user.name.split(" ").first %>! Let's get your feast up and running!</div>
    <% else %>
    <div class="welcome-header">Edit your feast</div>
    <% end %>
</div>

<div class="page">
    <div class="page-content">

    <div class="page-section-float-left">
      <% @course.errors.full_messages.each do |message| %>
        <div class="error-block"><div class="form-error">*<%= message %></div></div>
      <% end %>
    </div>

    <%= form_for @course, :html => { :multipart => true } do |f| %>
    
    <%= hidden_field_tag 'req', "#{@reqid}" %>
    
    <% for attribute in [:crop_x, :crop_y, :crop_w, :crop_h] %><% end %>

    <div class="page-section-float-left">

       <p>
       <%= f.label :title, 'Feast title:', :class => "form-question" %>
       <%= f.text_area :title, :class => "form-with-margin", :value => @reqtitle %>
       </p>
       <br><br>

       <div class="page-section-float-left">
       <p>
       <%= f.label :photo, 'Upload a photo', :class => "form-question" %>
       <%= image_tag(@course.photo,  :size => "190x120") if @course.photo.present? %>
       <%= f.file_field :photo %>
       </p>
       </div>

       <p>
       <%= f.label :description, 'Feast description:', :class => "form-question" %>
       <%= f.text_area :description, :class => "form-tall" %>
       </p>
     
       <div class="form-question">About the host</div>
       <br><br>
       <%= f.text_area :experience, :class => "form-med-with-margin" %>
     </div>
     
     
    <hr id="class"><br>

    <div class="page-section-float-left">
       <div class="class-form-question">Feast Capacity</div><br>
       <%= f.text_field :min_seats, :class => "form-short", :placeholder => "Min. # for me to host this event" %>
       <%= f.text_field :max_seats, :class => "form-short", :placeholder => "Max. # I can have for this event" %>
       <br><br>
    </div>

    <div class="page-section-float-left">
       <div class="class-form-question">When</div><br>          
         <%= f.datetime_select :starts_at, :ampm => true, :start_year => Time.now.year, :end_year => Time.now.year+1, :minute_step => 30, :default => 2.weeks.from_now %><br>
         <%= f.datetime_select :ends_at, :ampm => true, :start_year => Time.now.year, :end_year => Time.now.year+1, :minute_step => 30, :default => 2.weeks.from_now %>
    </div>


    <div class="page-section-float-left">
        <div class="class-form-question">Where</div><br>
            <p>
            <%= f.radio_button :public, true, :checked => true %>
            <%= f.label :public, 'Public location (ie. cafes, offices, etc)' %>
            <br>
            <%= f.radio_button :public, false %>
            <%= f.label :public, 'Private (ie. your house)' %>
            </p>
            
            <p>
              <%= f.text_field :place_name, :class => "form", :placeholder => "Name of location (ex. Jo's coffee)" %>
              <%= f.text_field :address, :class => "form", :placeholder => "Full address of location (Please enter #, Street, Suite and City)" %>
              <%= text_field_tag :location_lookup, "#{@course.city.try(:name)}, #{@course.city.try(:state)}" || "#{current_user.city.name}, #{current_user.city.state}", :placeholder => "City & State (ex. Austin, TX)", :class => "form-short-edit-profile"  %>
              <%= f.hidden_field :city_id %>
            </p>

        <script type="text/javascript">
          $(document).ready(function() {
            $('#location_lookup').keyup(function() {
              jQuery.get('<%= cities_path(:format => :json) %>',
                {q: $('#location_lookup').val()},
                function(data){
                  $('#city_select').html('');
                  if (data.length == 0) {
                    $('#city_select').append('<li>nothing found...</li>');
                  } else {
                    jQuery.each(data, function(index, value) {
                      $('#city_select').append('<li class="select-a-city" data-city-id="' + value.city.id + '">' +
                          value.city.name + ', ' + value.city.state +
                        '</li>');
                    });
                  }
                  
                }
              )
            })

            $('li.select-a-city').live("click", function() {
              $('#city_select').html('');
              $('#location_lookup').val($(this).text());
              $('#course_city_id').val($(this).attr('data-city-id'));
            })
          })
        </script>

        <ul id="city_select" style="display: block; border: 1px solid #D2D9DC; background-color: #fff; border-radius: 5px; width: 250px; padding-left: 10px; padding-bottom: 10px; margin-top: 65px">
        </ul>
        <br><br>
    </div>

    <div class="page-section-float-left">
      <div class="class-form-question">Price</div><br>
        <div style="float: left; margin-top: 5px; margin-right: 5px">$</div> <%= f.text_field :price, :class => "form-short", :stype => "float: left", :placeholder => "ex. 30 (no $ sign needed!)" %>
        <div style="float: left; margin-top: 5px">per person</div> 
    </div>

    <div class="page-section-float-left">
      <div class="form-question">Phone number (optional)</div><br>
      
      <%= f.text_field :phone_number, :class => "form-short", :placeholder => "ex. 321-111-1234" %>
    </div>

    <br><br>


   <%= f.submit "Submit", :class => "submit-proposal-button", :id => 'course_submit', :value => "Submit" %>

   <% end %>

   </div>
</div><!-- /end .page -->


