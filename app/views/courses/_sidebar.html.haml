.sidebar-white
  .sidebar-content-white

    = "Class min. of #{@current_course.min_seats}, max. of #{@current_course.seats}"
    %br
    %br
    - if (@current_course.date - Date.today).numerator < 1
      - if @current_course.teacher == current_user
        %p= "This class has passed."
        = button_to "Teach this again!", new_course_path, :method => :get, :class => "register-class-button"
      - else
        %p= "This class has passed."
        = button_to "Request a new one", "http://bit.ly/rAtf6o", :method => :get, :class => "register-class-button"
    - elsif @current_course.students.size >= course.max_seats
      - if @current_course.teacher == current_user
        = "Yay! Your class is sold out!"
        = button_to "Edit class profile", edit_course_path(:id => @current_course.id), :method => :get, :class => "edit-class-button"
      - elsif @current_course.is_a_student?(current_user)
        .edit-class-button= "You're already registered"
      - else
        = "Class is full already!"
        = button_to "Request a new one", "http://bit.ly/rAtf6o", :method => :get, :class => "register-class-button"
    - else
      - if @current_course.teacher == current_user
        = button_to "Edit class profile", edit_course_path(:id => @current_course.id), :method => :get, :class => "edit-class-button"
      - elsif @current_course.is_a_student?(current_user)
        .edit-class-button= "You're already registered"
      - else
        = button_to "Register for this class", payment_preview_path(:id => @current_course.id), :method => :put, :class => "register-class-button"


    .sidebar-block
      %ul.noBullet
        %li.noBullet
          = image_tag "/images/v2/icon_pricetag.png", :class => "class-details-icon-cost"
        %li.noBullet
          .class-details
            = "$" "#{course.price}"
            %br/
            / - if course.is_a_student?(current_user)
            / - else
            /   %a.class-alternatives(href="http://bit.ly/rAtf6o") Too much? Suggest a new price!
            %br/

      %ul.noBullet
        %li.noBullet
          = image_tag "/images/v2/icon_calendar.png", :class => "class-details-icon-when"
        %li.noBullet
          .class-details
            = course.date.strftime("%a %b %d, %Y")
          .class-sidebar-details
            = "#{course.time_range}"
            %br
          - if course.is_a_student?(current_user)
            / %a.class-alternatives(href="http://bit.ly/rAtf6o") Add to Google Calendar
            %br
          - else
            %a.class-alternatives(href="http://bit.ly/rAtf6o") Can't make it? Request a new time!
            %br/

      %ul.noBullet
        %li.noBullet
          = image_tag "/images/v2/icon_location.png", :class => "class-details-icon-where"
        %li.noBullet
          .class-sidebar-details
            = course.place_name
          - if course.public?
            .class-sidebar-details
              = course.address
          - else
            %p Private Address
          - if course.is_a_student?(current_user)
            - if course.public?
              / %a.class-alternatives(href="http://bit.ly/rAtf6o") View on Google Map
          - else
            %a.class-alternatives(href="http://bit.ly/rAtf6o") Don't live in this city? Request in yours!
            %br

    .sidebar-block-last
      .sidebar-heading Teacher
      .class-attendance-block
        / - if @current_course.teacher.photo.exists?
        /   = image_tag(@current_course.teacher.photo.url(:small), :size => "50x50")
        / - else
        /   = image_tag "/images/v2/Avatars_04_V1.png", :class => "avatar-medium"

        .class-details
          %a.profile-link
          = link_to "#{course.teacher.name}", profile_path(course.teacher), :class => "profile-link"
        / .class-details
        /   %ul.noBullet
        /     %li.noBullet
        /       %img.class-details-icon-heart{:src => '/images/v2/StatusIcon_heart.png'}
        /     %li.noBullet
        /       %p.class-details-heart-number
        /         = course.votes_for
        %p.class-details
          - if course.experience.blank?
            = "#{course.teacher.bio}"
          - else
            = course.experience


      - if course.teacher != current_user
        %img.class-details-icon-email{:src => '../../../images/v2/icon_email.png'}
        = link_to "Contact teacher", contact_teacher_path(:id => course.id)

    - if course.students.any?
      .sidebar-block-last
        .sidebar-heading Students
        .class-attendance-block
          - course.students.each do |student|
            %a.profile-link
              = link_to student.name, profile_path(student), :class => "profile-link"
              %br

        - if course.teacher == current_user
          %img.class-details-icon-email{:src => '../../../images/v2/icon_email.png'}
          = link_to "Contact students", contact_all_students_path(:id => course.id)

